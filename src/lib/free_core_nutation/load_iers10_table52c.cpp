#include "fcn.hpp"

namespace {
/* IERS 2010 Section 5.5.5, Table 5.2.c */
struct {
  int mjd;
  double xc, xs, sx;
} Table52c[] = {
    {45700, 4.55e0, -36.58e0, 19.72e0},     // 1984.0
    {46066, -141.82e0, -105.35e0, 11.12e0}, // 1985.0
    {46431, -246.56e0, -170.21e0, 9.47e0},  // 1986.0
    {46796, -281.89e0, -159.24e0, 8.65e0},  // 1987.0
    {47161, -255.05e0, -43.58e0, 8.11e0},   // 1988.0
    {47527, -210.46e0, -88.56e0, 7.31e0},   // 1989.0
    {47892, -187.79e0, -57.35e0, 6.41e0},   // 1990.0
    {48257, -163.01e0, 26.26e0, 5.52e0},    // 1991.0
    {48622, -145.53e0, 44.65e0, 4.80e0},    // 1992.0
    {48988, -145.12e0, 51.49e0, 5.95e0},    // 1993.0
    {49353, -109.93e0, 16.87e0, 9.45e0},    // 1994.0
    {49718, -87.30e0, 5.36e0, 8.25e0},      // 1995.0
    {50083, -90.61e0, 1.52e0, 7.67e0},      // 1996.0
    {50449, -94.73e0, 35.35e0, 4.40e0},     // 1997.0
    {50814, -67.52e0, 27.57e0, 3.40e0},     // 1998.0
    {51179, -44.11e0, -14.31e0, 3.45e0},    // 1999.0
    {51544, 5.21e0, -74.87e0, 3.26e0},      // 2000.0
    {51910, 70.37e0, -129.66e0, 2.86e0},    // 2001.0
    {52275, 86.47e0, -127.84e0, 2.75e0},    // 2002.0
    {52640, 110.44e0, -42.73e0, 2.59e0},    // 2003.0
    {53005, 114.78e0, -0.13e0, 2.53e0},     // 2004.0
    {53371, 132.96e0, -4.78e0, 2.72e0},     // 2005.0
    {53736, 157.36e0, 28.63e0, 2.19e0},     // 2006.0
    {54101, 160.40e0, 58.87e0, 1.87e0},     // 2007.0
    {54466, 156.76e0, 101.24e0, 1.74e0},    // 2008.0
    {54832, 142.99e0, 143.01e0, 1.89e0},    // 2009.0
    {55197, 33.70e0, 184.46e0, 1.95e0},     // 2010.0
    {55562, 0.76e0, 253.70e0, 1.14e0},      // 2011.0
    {55927, 25.47e0, 271.66e0, 1.07e0},     // 2012.0
    {56293, 113.42e0, 256.50e0, 1.86e0}     // 2013.0
};

constexpr const int Table52c_size = sizeof(Table52c) / sizeof(Table52c[0]);
} /* unnamed namespace */

std::vector<dso::fcn::LambertCoefficients>
dso::fcn::load_iers10_table52c() noexcept {
  std::vector<dso::fcn::LambertCoefficients> vec;
  vec.reserve(Table52c_size);
  for (int i = 0; i < Table52c_size; i++) {
    vec.emplace_back(
        dso::MjdEpoch(Table52c[i].mjd, dso::FractionalSeconds{0e0}),
        Table52c[i].xc, Table52c[i].xs, Table52c[i].sx);
  }
  return vec;
}
