\section{\gls{eop}}\label{sec:eop}

\glspl{eop} are needed in a number of places within an orbit determination or 
satellite data analysis proccess. We need efficient ways to:
\begin{enumerate}
  \item retrieve \gls{eop} data files, 
  \item parse and store information, and 
  \item get/interpolate \gls{eop} values for epochs of interest
\end{enumerate}

\subsection{\gls{eop} Products}\label{ssec:eop-products}

Various \gls{eop} product files are made available by a number of different 
sources. Here, we focus on products made available by the \gls{iers}. 

Historically, \gls{iers} provides ``series'' of \gls{eop} products, combining 
different data sets and consistent with different frames. The reference time 
series of \glspl{eop} is called \emph{EOP C04}. This is further categorized in 
\emph{EOP 14C04} aligned with ITRF2014 and ICRF2 (\cite{Bizouard2019}) and 
\emph{EOP 20C04} aligned with ITRF2020 (\cite{iersmail471}). Note that the latter 
follows a slightly different format from the former.

More information can be found on the \gls{iers} website, e.g. 
\href{https://hpiers.obspm.fr/iers/eop/eopc04_14/updateC04.txt}{updateC04.txt} 
and \href{https://hpiers.obspm.fr/iers/eop/eopc04/eopc04.txt}{eopc04.txt}. 
Relevant files can be retrieved from the \gls{iers} website, e.g. 
\href{https://hpiers.obspm.fr/iers/eop/eopc04/eopc04.1962-now}{eopc04.1962-now} for 
\emph{EOP 20C04} and \href{https://hpiers.obspm.fr/iers/eop/eopc04_14/eopc04_IAU2000.62-now}{eopc04\_IAU2000.62-now}.

\subsection{Parsing \gls{eop} Products and Data Structures}\label{ssec:parsing-eop-products-and-data-structures}

At the time of writting, we can parse both \emph{EOP 14C04} and \emph{EOP 20C04} data files. 
The relevant function call, will automatically choose the right format and parse 
\gls{eop} values for a given time range. The values will be stored in a so-called 
\texttt{EopSeries} data structure for further use.

\begin{warning}
\gls{iers}-published \gls{eop} product files contain tabulated values, ``time-stamped'' 
in \gls{utc}. When parsing the files however, the time scale is changed to \gls{tt}.
\end{warning}

\subsection{\gls{eop} Interpolation}\label{ssec:eop-interpolation}

Once parsed and stored, one can interpolate \gls{eop} values to any given epoch. 
Interpolation is perfomed using polynomial interpolation, via the \emph{Lagrange} method. 
There are a couple of things going on, to effectively and accuratelly interpolate 
series of \glspl{eop}:
\begin{itemize}
  \item \gls{eop} data should be stored in an \texttt{EopSeries} data structure. 
    Any given instance of this data structure, holds \gls{eop} time series for 
    a given date range.
  \item High frequency effects (i.e. with periods less than one day) have to be 
    taken into consideration when interpolating. These are described in Chapters 
    5.5.1 and 5.5.3 of \cite{iers2010} and \cite{Bradley2016}. These include:
    
    \begin{itemize}
      \item Variations $(\Delta x, \Delta y)_{libration}$ in polar motion; these are 
        mainly diurnal nutations in polar motion that originate from the direct 
        effect of the external (mainly luni-solar) torque on the non-axisymmetric 
        part of the Earth. \gls{iers} publishes the 
        \href{https://iers-conventions.obspm.fr/content/chapter5/software/PMSDNUT2.F}{PMSDNUT2} 
        software to model these effects. Within this library, the computations are 
        performed by the function \lstinline{dso::xypole_libration}.

        Apart from the aforementioned libration effect which causes small variations 
        in the pole coordinates $(x_p , y_p)$, the \gls{eop} parameters 
        $\Delta UT1$ and $\Delta LOD$ are also affected. The values of these 
        variations can be computed with the \gls{iers} published software 
        \href{https://iers-conventions.obspm.fr/content/chapter5/software/UTLIBR.F}{UTLIBR.F}; 
        in this library, these computations are performed by the \lstinline{dso::utlod_libration}.

      \item Variations $(\Delta x, \Delta y)_{ocean tides}$ in polar motion; these 
        are tidal variations in Earth orientation, including diurnal and semi-diurnal 
        variations in pole coordinates caused by ocean tides. \gls{iers} publishes the 
        \href{https://iers-conventions.obspm.fr/content/chapter8/software/ORTHO_EOP.F}{ORTHO\_EOP.F} 
        software to model these effects. Within this library, the computations are 
        performed by the function \lstinline{dso::xypole_oceantide}.

    \end{itemize}

\end{itemize}

\begin{figure}
  \centering
  \input{eop_variations.pgf}
  \caption{Ocean tide and libration effects on \glspl{eop} computed as descibed in \cite{iers2010}. 
    Values here are computed using the \protect\href{https://hpiers.obspm.fr/iers/models/interp.f}{interp} and 
    \protect\href{https://iers-conventions.obspm.fr/content/chapter5/software/UTLIBR.F}{UTLIBR} software. 
    See also the \path{test/fortran/eop_variations.f} and \path{test/fortran/plot_eop_variations.py} 
    source files.}
  \label{fig:eop-variations}
\end{figure}
