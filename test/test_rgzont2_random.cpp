#include "iers2010.hpp"
#include <cassert>

constexpr double PRECISION_DUT = 1e-13;
constexpr double PRECISION_DLOD = 1e-15;
constexpr double PRECISION_DOMEGA = 1e-17;

int main() {
  printf("Testing RG_ZONT2 results vs Fortran\n"); 
  printf("Precision for DUt    = %.15e [sec]\n", PRECISION_DUT);
  printf("Precision for DLod   = %.15e [sec/day]\n", PRECISION_DLOD);
  printf("Precision for DOmega = %.15e [rad/sec]\n", PRECISION_DOMEGA);

  double dut, dlod, domega;

  /* paste results from make_test_rgzont2.f here */
  struct Result {double t,dut,dlod,domega;}R[]={
{.9224489680684900827501E+00, -0.10685148180279005E+00,  0.96254821873884491E-04, -0.81236625402521791E-13},
{.3082556001844083404251E-01, -0.14231412631765022E+00, -0.40849799630372194E-03,  0.34476805106268822E-12},
{.4800675236968774406421E+00,  0.16412046596977276E+00, -0.10762567444994439E-03,  0.90837940082496826E-13},
{.2360828182087572058023E+00, -0.71951825352778290E-01, -0.63678364560835294E-03,  0.53744458223525602E-12},
{.7437639703582292760586E+00, -0.13689480331006387E+00,  0.64252362849074991E-05, -0.54220744882978876E-14},
{.6395972686306916621390E-01, -0.10167895282458898E-01, -0.96891578611354743E-04,  0.81775068215412289E-13},
{.2242584535731185768626E+00, -0.12686180923004259E+00, -0.45111778566553628E-03,  0.38074045346713997E-12},
{.5791442917960920588882E+00, -0.16320651436948935E+00, -0.25970189186503434E-03,  0.21918932899753682E-12},
{.4554827892743832373768E+00,  0.96922854518380924E-01,  0.27123419420647612E-03, -0.22891919606457928E-12},
{.8556233809551196944909E+00,  0.16725820107512410E+00,  0.26880940811471470E-04, -0.22690329954344129E-13},
{.5996461754793019904852E+00, -0.11483408938696167E+00, -0.70095396450284460E-03,  0.59160107911966887E-12},
{.8087488286668442771798E-01,  0.87642339113514989E-01, -0.68392211730306397E-03,  0.57722400147702057E-12},
{.4760730833155983887650E+00,  0.16117996607726479E+00,  0.18475706547796668E-04, -0.15593930034769690E-13},
{.3525902936993797753829E+00, -0.50371942599022446E-01,  0.48220135989036683E-03, -0.40697644986782904E-12},
{.6871792228882714903548E+00,  0.13608574286166028E+00, -0.21157202910015942E-04,  0.17858503964319380E-13},
{.4355760858125097279014E+00, -0.84661130613816488E-03, -0.17625980743486095E-03,  0.14876088135114352E-12},
{.1664770024124341274430E+00, -0.43151203642674454E-01,  0.28169491498547891E-03, -0.23774781322340365E-12},
{.2435111173352000335512E+00, -0.46741122395932665E-01, -0.20457446043135305E-03,  0.17266020910931232E-12},
{.2130750970647765640820E-01, -0.15707643095154916E+00,  0.22880662734485048E-03, -0.19310983362939200E-12},
{.4711646622382277271868E+00,  0.15148964070886389E+00,  0.71852703971213153E-03, -0.60643364323818033E-12},
{.4166872533273477952065E+00, -0.97163795324909999E-01, -0.31463660119205243E-04,  0.26555916531719702E-13},
{.1868139727025019958262E-01, -0.16635126690684007E+00,  0.45515983409497550E-03, -0.38415296038854907E-12},
{.1626932732064024778040E+00, -0.32825080107539470E-01,  0.67021308511104399E-03, -0.56565646259151424E-12},
{.8624349352317808303781E+00,  0.15443548855367609E+00,  0.19427361210064327E-03, -0.16396796098513573E-12},
{.3715003703071950713621E-01, -0.12622937776691170E+00, -0.46453933645531433E-03,  0.39206871227009158E-12},
{.1252486464754463124649E+00,  0.14635734363448197E+00, -0.98157056103761572E-04,  0.82844628758037488E-13},
{.6970867065853147970245E-01,  0.28525641491944091E-01, -0.76644789012782959E-03,  0.64687671200094401E-12},
{.8486415575925878584940E+00,  0.15171836504783850E+00, -0.24011231012030035E-03,  0.20265477707491782E-12},
{.8944286348449959067608E-01,  0.11767188444086706E+00, -0.41057360527516903E-03,  0.34652263503611722E-12},
{.6385759766019842853524E+00,  0.77765149445314499E-01, -0.56740285557311762E-03,  0.47888414008754469E-12},
{.1566875250165170596617E+00,  0.91231166795802520E-02,  0.61063793771511793E-03, -0.51537462656439170E-12},
{.6054586884101278432269E+00, -0.85156731013419834E-01,  0.43049391515734942E-03, -0.36333564587306340E-12},
{.7569901191954501173953E+00, -0.15591199532725766E+00,  0.51163113635235207E-03, -0.43181910238140730E-12},
{.4633559292462663403711E+00,  0.11848412747480902E+00,  0.76595193441325046E-04, -0.64648072659943351E-13},
{.3119847020703121476259E+00,  0.14266906100543392E+00,  0.86377040813217216E-04, -0.72901557320196812E-13},
{.1956449571265778120122E+00, -0.14997082627283786E+00,  0.80933010910786291E-05, -0.68298230827798177E-14},
{.4943794148631648344150E+00,  0.14944421773776734E+00,  0.96116011811288505E-04, -0.81124652514649467E-13},
{.9718298509410454588675E+00, -0.11329796419592872E+00, -0.48623509146521909E-03,  0.41037727285747954E-12},
{.6114332420625601116626E+00, -0.57779843662459716E-01,  0.65863228751248282E-03, -0.55588355735077735E-12},
{.5529175357422662084872E+00, -0.12056948501799894E+00, -0.11558363876382622E-03,  0.97555286824474371E-13},
{.4349092796758761148013E+00, -0.90438402482131558E-02,  0.29542080038396517E-03, -0.24933286508260019E-12},
{.7305657009354742381646E+00, -0.71529475921163682E-01, -0.10484208998266329E-03,  0.88484314167993356E-13},
{.7797956333099311798662E+00, -0.13433703243720072E+00,  0.32535244045038059E-03, -0.27459619154014826E-12},
{.3856289594148526456152E+00, -0.15536654206736886E+00, -0.11431811744012117E-03,  0.96483049272597660E-13},
{.2183917723827909496137E+00, -0.14612344500923757E+00,  0.64870569052123878E-03, -0.54750431007786058E-12},
{.5252336046721850504326E-01, -0.66670223833531064E-01, -0.31838113345699102E-03,  0.26871202359631341E-12},
{.2521528788348285088361E+00,  0.57808847894229099E-02, -0.41224339700848079E-03,  0.34793169841395366E-12},
{.9432781001050666302987E+00, -0.16562364445438602E+00,  0.20529257357613126E-03, -0.17326891992962547E-12},
{.3873553243116900635101E+00, -0.15860228806073401E+00,  0.40887948173956606E-03, -0.34509154140696601E-12},
{.5231272967215925273621E+00,  0.32694820344905888E-01,  0.44891822520907592E-03, -0.37888457513316943E-12},
{.3983212653742254083511E+00, -0.16010906308175765E+00,  0.90738174413887641E-04, -0.76577787714322676E-13},
{.9029446482994800682320E+00, -0.10885157244187316E-01,  0.17387182752935060E-04, -0.14673474840463145E-13},
{.6343046065891944085280E-01, -0.12079137335346088E-01, -0.16100194571572429E-03,  0.13588331761651545E-12},
{.2124458833144775571355E+00, -0.15948337711922297E+00,  0.58453731855486564E-03, -0.49334622991967765E-12},
{.6303847856006149497077E+00,  0.43910952578492916E-01, -0.23981454914516023E-03,  0.20240275002780784E-12},
{.9040429710728455914293E+00, -0.14169507978176564E-01, -0.10884242409876615E-03,  0.91859335010506680E-13},
{.2386757501099689982027E+00, -0.67788313115157123E-01, -0.33496881376207367E-03,  0.28271162950494380E-12},
{.5971594097488871488721E+00, -0.11976966514987188E+00,  0.37618110612764493E-03, -0.31749356008084939E-12},
{.1155655669458255374593E-01, -0.15519847375275694E+00,  0.38118123002580620E-03, -0.32171679278503084E-12},
{.1911945855901048263448E+00, -0.14267650155286282E+00,  0.97298400224858235E-04, -0.82121326088206207E-13},
{.8000250655479509420687E+00, -0.46846887735185298E-01,  0.49676504696898955E-04, -0.41924725380278718E-13},
{.9421863579210152384036E+00, -0.16161570272477199E+00,  0.53847113389924675E-04, -0.45445362254572432E-13},
{.5666546869942011843690E+00, -0.14930652103825420E+00,  0.58925128127379504E-04, -0.49731975872186595E-13},
{.6572409198326016888103E+00,  0.14954518461135721E+00, -0.43674276582214550E-03,  0.36860720087985050E-12},
{.5748057150949763549619E+00, -0.16208375134909128E+00,  0.50340216578915388E-04, -0.42490523905425944E-13},
{.9280912708496147356385E-01,  0.12489246626846849E+00, -0.42924827903995143E-03,  0.36228399127242754E-12},
{.8862151606407192572235E+00,  0.89904607212260623E-01,  0.35287594420766941E-03, -0.29782469662548011E-12},
{.8368499657393123625226E+00,  0.13463327193944402E+00, -0.13399160748884045E-03,  0.11309082493879215E-12},
{.9520663960242137235923E+00, -0.16147952201632557E+00, -0.73983152521930971E-04,  0.62438955819114708E-13},
{.9047095859421312447068E+00, -0.13535256309463737E-01, -0.20108517660771668E-04,  0.16971790781075759E-13},
{.4671233326822505915743E+00,  0.13903651871364206E+00,  0.63414594887386964E-04, -0.53523390402857933E-13},
{.1184160408972613209855E+00,  0.15317837326344683E+00,  0.19309229717829585E-03, -0.16296400560168872E-12},
{.6394095886550815732718E+00,  0.84109131540160587E-01,  0.10592105020888581E-03, -0.89396823485562379E-13},
{.4165441129945882670071E+00, -0.96238188121657450E-01,  0.11388852327637840E-03, -0.96120053687941167E-13},
{.6532338185832875510073E-01,  0.80353248946597317E-02,  0.28349206990543142E-03, -0.23926665241244998E-12},
{.6437944820089224196025E+00,  0.98853590114085163E-01, -0.71157664545432628E-03,  0.60056658032424149E-12},
{.7460516115259970826301E+00, -0.13230543450875659E+00,  0.25392395565757155E-03, -0.21431449744049881E-12},
{.7321633993752547642231E+00, -0.84329085671277115E-01,  0.48077832489888688E-03, -0.40577542152753067E-12},
{.3390093697036745679085E+00,  0.24581918060657838E-01, -0.18915123018836994E-03,  0.15964229169748712E-12},
{.3076547152515165528541E+00,  0.15151768702330320E+00,  0.46236925720036140E-03, -0.39023687791829408E-12},
{.2554177417439359443208E+00,  0.28472003578091650E-01,  0.27417774699432372E-03, -0.23140359949295783E-12},
{.8843099142131346512841E+00,  0.90501739172937842E-01, -0.40893121331948465E-03,  0.34513393089823166E-12},
{.8624936982234389093449E+00,  0.15425576325142801E+00, -0.34200557003172438E-04,  0.28863927092971981E-13},
{.7883425767033480635604E+00, -0.10765828682724174E+00,  0.22889153676828116E-03, -0.19317905705212685E-12},
{.9106211796001200120543E+00, -0.41218758871552949E-01,  0.10283626581109272E-03, -0.86792145977421205E-13},
{.5905260800027167800152E-01, -0.32747686746378839E-01,  0.14330667180730420E-03, -0.12095011948046225E-12},
{.7568396727268533741295E-01,  0.64319043427099598E-01, -0.74582835143941319E-03,  0.62947299634284696E-12},
{.8454002556440004534366E+00,  0.15617632025274131E+00, -0.33582932945901053E-03,  0.28343516281194164E-12},
{.7857967814574050580134E+00, -0.10942235023851966E+00,  0.26358746748693477E-03, -0.22246658301991403E-12},
{.4985618641557320041002E+00,  0.13673915858541166E+00, -0.75609572666907273E-05,  0.63824725032785778E-14},
{.5937594919479577404431E+00, -0.13935952285440609E+00, -0.42466547918049787E-03,  0.35841368327962712E-12},
{.9192996337228162007094E+00, -0.90377968537354386E-01,  0.47803713738059958E-03, -0.40346014793555719E-12},
{.5027390677205901825531E+00,  0.12496929896418843E+00, -0.43164017017029491E-04,  0.36431750434843522E-13},
{.5706082712663798073294E+00, -0.15321699564042376E+00, -0.58351366239751339E-04,  0.49246905053116435E-13},
{.6014764930211099480672E+00, -0.10454205350200624E+00, -0.23970228679900225E-03,  0.20230824089908468E-12},
{.6608072087470135969056E+00,  0.15719194515768070E+00,  0.22143110642022269E-03, -0.18688576095312563E-12},
{.6371172072283229903533E+00,  0.77366149080430574E-01, -0.13600920994089516E-03,  0.11479107447898925E-12},
{.8699220313946721683251E+00,  0.14492366174694996E+00, -0.15092198533415161E-03,  0.12737770153099610E-12},
{.3092141801978262050099E+00,  0.14585519635745522E+00,  0.16309657727648052E-03, -0.13765012058593001E-12},
{.4699094454919894303657E+00,  0.14610676055895203E+00, -0.36974810095352000E-03,  0.31206634372682462E-12}};
for (int i=0; i<  100; i++) {
  iers2010::rg_zont2(R[i].t,dut,dlod,domega);
  assert(std::abs(dut-R[i].dut)<PRECISION_DUT);
  assert(std::abs(dlod-R[i].dlod)<PRECISION_DLOD);
  assert(std::abs(domega-R[i].domega)<PRECISION_DOMEGA);
}
  /* end of FORTRAN source */

  printf("All tests passed!\n");
  return 0;
}
